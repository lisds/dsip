

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Naive Bayes classifiers &#8212; Data Science in Practice</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'naive_bayes';</script>
    <link rel="canonical" href="https://lisds.github.io/dsip/naive_bayes.html" />
    <link rel="shortcut icon" href="_static/dsfe_favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/dsfe_logo.png" class="logo__image only-light" alt="Data Science in Practice - Home"/>
    <script>document.write(`<img src="_static/dsfe_logo.png" class="logo__image only-dark" alt="Data Science in Practice - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="assert.html">Using <code class="docutils literal notranslate"><span class="pre">assert</span></code> for testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays_and_images.html">Arrays as images, images as arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="where_and_argmin.html">Where and argmin</a></li>
<li class="toctree-l1"><a class="reference internal" href="where_2d.html">Where in 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_for_optimize.html">2D arrays, images, optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="pathlib.html">Using the <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dictionaries.html">Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas_and_dicts.html">Pandas and dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda_functions.html">Lambda functions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reading formulae</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="numpy_and_vectors.html">Numpy, arrays, and vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebra_of_sums.html">Some algebra with summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lin_regression_notation.html">Notation for linear regression models</a></li>
<li class="toctree-l1"><a class="reference internal" href="lin_regression_multiple_predictors.html">Linear regression notation for models with multiple predictors</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_regression_categorical_predictors.html">Categorical predictors in linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_predictors_statistical_adjustment.html">Statistical Adjustment in Multi-predictor Linear Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="epl_modeling.html">Attack or defense?  An example of multiple regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Working with data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data_work.html">The problem with data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing on your computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-problem-with-notebooks.html">The joys and sorrows of notebooks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/lisds/dsip/main?urlpath=lab/tree/naive_bayes.Rmd" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://ds.lis.2i2c.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/lisds/dsip&urlpath=lab/tree/dsip/naive_bayes.Rmd&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lisds/dsip" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lisds/dsip/edit/main/naive_bayes.Rmd" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lisds/dsip/issues/new?title=Issue%20on%20page%20%2Fnaive_bayes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/naive_bayes.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Naive Bayes classifiers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-the-naive-into-naive-bayes">Putting the naïve into “naïve Bayes”</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="naive-bayes-classifiers">
<h1>Naive Bayes classifiers<a class="headerlink" href="#naive-bayes-classifiers" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.copy_on_write&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Also see: <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/05.05-naive-bayes.html">Naive Bayes
classifiers</a>
in the <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook">Python Data Science
Handbook</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/penguins.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">penguins</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>55.8</td>
      <td>19.8</td>
      <td>207.0</td>
      <td>4000.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>43.5</td>
      <td>18.1</td>
      <td>202.0</td>
      <td>3400.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>49.6</td>
      <td>18.2</td>
      <td>193.0</td>
      <td>3775.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.8</td>
      <td>19.0</td>
      <td>210.0</td>
      <td>4100.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.2</td>
      <td>18.7</td>
      <td>198.0</td>
      <td>3775.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
<p>333 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f018b8d8f10&gt;
</pre></div>
</div>
<img alt="_images/4ccee6cd1036f19a6fc38e782c6f918a3cd209b4a6f81e10e1e8be13d85f430d.png" src="_images/4ccee6cd1036f19a6fc38e782c6f918a3cd209b4a6f81e10e1e8be13d85f430d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;species&#39;,
 &#39;island&#39;,
 &#39;bill_length_mm&#39;,
 &#39;bill_depth_mm&#39;,
 &#39;flipper_length_mm&#39;,
 &#39;body_mass_g&#39;,
 &#39;sex&#39;,
 &#39;year&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">,</span> <span class="s1">&#39;Chinstrap&#39;</span><span class="p">]),</span>
    <span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;body_mass_g&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;body_mass_g&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="_images/d1ad5a7b31f3386cf86a9739e31230f75945c8fbc424fb78aa5815d587c7de04.png" src="_images/d1ad5a7b31f3386cf86a9739e31230f75945c8fbc424fb78aa5815d587c7de04.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_species</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="n">bm_by_species</span> <span class="o">=</span> <span class="n">by_species</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">));</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Gentoo&#39;)
</pre></div>
</div>
<img alt="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" src="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" />
</div>
</div>
<p>While we are here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
<span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Chinstrap&#39;, &#39;Gentoo&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">position_no</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">position_no</span><span class="p">,</span> <span class="s1">&#39;name is&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">position_no</span> <span class="o">=</span> <span class="n">position_no</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group 0 name is Chinstrap
Group 1 name is Gentoo
</pre></div>
</div>
</div>
</div>
<p>Or:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">position_no</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">position_no</span><span class="p">,</span> <span class="s1">&#39;name is&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group 0 name is Chinstrap
Group 1 name is Gentoo
</pre></div>
</div>
</div>
</div>
<p>The plots again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">groups</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" src="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" />
</div>
</div>
<p>As density plots (the area of the bars sums to 1):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">groups</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0b5ea5243c3f31ffaeee5972e29bc116abb62ab165031b3c3499dd70b73e0bf.png" src="_images/a0b5ea5243c3f31ffaeee5972e29bc116abb62ab165031b3c3499dd70b73e0bf.png" />
</div>
</div>
<p>For the moment, let us model these two distributions as normal curves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bm_params</span> <span class="o">=</span> <span class="n">bm_by_species</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="n">bm_params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>species</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chinstrap</th>
      <td>3733.088235</td>
      <td>384.335081</td>
    </tr>
    <tr>
      <th>Gentoo</th>
      <td>5092.436975</td>
      <td>501.476154</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use a Scipy statistics distribution to make a <em>normal</em> distribution with the same mean and variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">sps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The distribution</span>
<span class="n">chinstrap_dist</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                          <span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The probability density function of the distribution:</span>
<span class="n">chinstraps</span> <span class="o">=</span> <span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">)</span>
<span class="n">c_masses_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">chinstraps</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">chinstraps</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">,</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f01824bf9a0&gt;]
</pre></div>
</div>
<img alt="_images/a7774108334c10f2c8d1c27e757076d03cf6f5773688965cebe3b5e4e6500077.png" src="_images/a7774108334c10f2c8d1c27e757076d03cf6f5773688965cebe3b5e4e6500077.png" />
</div>
</div>
<p>With the actual densities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">chinstraps</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">,</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0182445160&gt;]
</pre></div>
</div>
<img alt="_images/b04bee634e1ca01c56a263d2bc6e757df454ba414c254e6e6e771ec4c3c51080.png" src="_images/b04bee634e1ca01c56a263d2bc6e757df454ba414c254e6e6e771ec4c3c51080.png" />
</div>
</div>
<p>The normal (Gaussian) probability density function gives our estimate of the probability (density) of any given weight.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">3500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0008636377972201158
</pre></div>
</div>
</div>
</div>
<p>With these we can get the probability of any mass in the dataset given that the penguin is a Chinstrap:</p>
<div class="math notranslate nohighlight">
\[
P(\text{mass} | \text{Chinstrap})
\]</div>
<p>Let’s fill those in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpms</span> <span class="o">=</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 4 columns</p>
</div></div></div>
</div>
<p>Likewise:</p>
<div class="math notranslate nohighlight">
\[
P(\text{mass}|\text{Gentoo})
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gentoo_dist</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                       <span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="n">gentoos</span> <span class="o">=</span> <span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">g_masses_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">gentoos</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gentoos</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">gentoos</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g_masses_x</span><span class="p">,</span> <span class="n">gentoo_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">g_masses_x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gentoo density and estimated density&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Gentoo density and estimated density&#39;)
</pre></div>
</div>
<img alt="_images/654eca1fd88d7112dc0c17c27ace9d3099478ad565af9138da034a9f0ad54bb0.png" src="_images/654eca1fd88d7112dc0c17c27ace9d3099478ad565af9138da034a9f0ad54bb0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpms</span> <span class="o">=</span> <span class="n">gentoo_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gpms</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 5 columns</p>
</div></div></div>
</div>
<p>We also need prior probabilities for Chinstrap and Gentoo.</p>
<div class="math notranslate nohighlight">
\[
P(\text{Chinstrap})
\]</div>
<div class="math notranslate nohighlight">
\[
P(\text{Gentoo})
\]</div>
<p>Let’s just use the proportions in the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_chinstrap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Chinstrap&#39;</span><span class="p">)</span>
<span class="n">p_chinstrap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36363636363636365
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_gentoo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">p_gentoo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6363636363636364
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_chinstrap</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_gentoo</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 7 columns</p>
</div></div></div>
</div>
<p>In our model, each individual mass can only come about in one of two situations: the penguin is a Chinstrap, or the penguin is a Gentoo.  These are mutually exclusive:</p>
<p>Thus:</p>
<div class="math notranslate nohighlight">
\[
P(\text{mass}) = P(\text{mass} | \text{Chinstrap}) +
                 P(\text{mass} | \text{Gentoo})
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 8 columns</p>
</div></div></div>
</div>
<p>How we have everything we need to work out the <em>posterior</em> probability that a penguin is a Chinstrap, given the weight of the penguin:</p>
<div class="math notranslate nohighlight">
\[
P(\text{Chinstrap} | \text{mass}) = \frac{
P(\text{mass} | \text{Chinstrap}) P(\text{Chinstrap})
}{P(\text{mass})}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_mass&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 9 columns</p>
</div></div></div>
</div>
<p>Likewise:</p>
<div class="math notranslate nohighlight">
\[
P(\text{Gentoo} | \text{mass}) = \frac{
P(\text{mass} | \text{Gentoo}) P(\text{Gentoo})
}{P(\text{mass})}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_g_given_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_mass&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
      <td>0.468574</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
      <td>0.418540</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
      <td>0.636281</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
      <td>0.053040</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
      <td>0.002379</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
      <td>0.092726</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bayes_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_g_given_m&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
      <td>0.468574</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
      <td>0.418540</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
      <td>0.636281</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
      <td>0.053040</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
      <td>0.002379</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
      <td>0.092726</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 11 columns</p>
</div></div></div>
</div>
<p>But - wait - for our Bayes predictions, we don’t actually need the <span class="math notranslate nohighlight">\(P(\text{mass})\)</span> value.  Why?  Because we can calculate the ratio of the posterior probabilities like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">likelihood_ratio</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_g_given_m&#39;</span><span class="p">]</span>
<span class="n">likelihood_ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>152      0.204621
153      0.000003
154      0.297392
155      0.000003
156      0.000074
          ...    
339      6.284476
340    152.304860
341     23.367677
342      3.350179
343     23.367677
Length: 187, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Notice we have divided out the <span class="math notranslate nohighlight">\(P(\text{mass})\)</span> in this ratio.  Notice too that ratios above 1 mean more likely Chinstrap, and less than one mean less likely Chinstrap, more likely Gentoo.  So we get the same predictions from the likelihood as we would from the full posterior probabilities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">likelihood_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">likelihood_ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bayes_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">likelihood_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Here is the same process, using the Scikit-learn library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]);</span>
<span class="n">model</span><span class="o">.</span><span class="n">class_prior_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.36363636, 0.63636364])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sklearn_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
      <td>0.468574</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
      <td>0.418540</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
      <td>0.636281</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
      <td>0.053040</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
      <td>0.002379</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
      <td>0.092726</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bayes_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sklearn_predictions&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]])</span>
<span class="n">p_values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.16697628, 0.83302372],
       [0.00000265, 0.99999735],
       [0.22643912, 0.77356088],
       [0.00000265, 0.99999735],
       [0.00006465, 0.99993535],
       [0.11993516, 0.88006484],
       [0.01747265, 0.98252735],
       [0.00047123, 0.99952877],
       [0.29796695, 0.70203305],
       [0.00076041, 0.99923959],
       [0.05807624, 0.94192376],
       [0.00001352, 0.99998648],
       [0.05807624, 0.94192376],
       [0.00000049, 0.99999951],
       [0.6358983 , 0.3641017 ],
       [0.00000049, 0.99999951],
       [0.70958652, 0.29041348],
       [0.        , 1.        ],
       [0.01747265, 0.98252735],
       [0.00010738, 0.99989262],
       [0.00000265, 0.99999735],
       [0.00305663, 0.99694337],
       [0.29796695, 0.70203305],
       [0.00193689, 0.99806311],
       [0.00305663, 0.99694337],
       [0.00121811, 0.99878189],
       [0.00000459, 0.99999541],
       [0.08424419, 0.91575581],
       [0.00001352, 0.99998648],
       [0.00028991, 0.99971009],
       [0.03941269, 0.96058731],
       [0.00193689, 0.99806311],
       [0.00000005, 0.99999995],
       [0.00076041, 0.99923959],
       [0.00006465, 0.99993535],
       [0.00478639, 0.99521361],
       [0.00028991, 0.99971009],
       [0.37927671, 0.62072329],
       [0.00010738, 0.99989262],
       [0.897057  , 0.102943  ],
       [0.00000265, 0.99999735],
       [0.46620345, 0.53379655],
       [0.02639328, 0.97360672],
       [0.00001352, 0.99998648],
       [0.00743472, 0.99256528],
       [0.6358983 , 0.3641017 ],
       [0.00006465, 0.99993535],
       [0.00121811, 0.99878189],
       [0.00017707, 0.99982293],
       [0.01145015, 0.98854985],
       [0.00017707, 0.99982293],
       [0.29796695, 0.70203305],
       [0.00305663, 0.99694337],
       [0.00743472, 0.99256528],
       [0.00193689, 0.99806311],
       [0.46620345, 0.53379655],
       [0.00305663, 0.99694337],
       [0.22643912, 0.77356088],
       [0.00001352, 0.99998648],
       [0.6358983 , 0.3641017 ],
       [0.00017707, 0.99982293],
       [0.29796695, 0.70203305],
       [0.00000459, 0.99999541],
       [0.03941269, 0.96058731],
       [0.00000265, 0.99999735],
       [0.00000086, 0.99999914],
       [0.03941269, 0.96058731],
       [0.00001352, 0.99998648],
       [0.02639328, 0.97360672],
       [0.00305663, 0.99694337],
       [0.00121811, 0.99878189],
       [0.00047123, 0.99952877],
       [0.03941269, 0.96058731],
       [0.00000086, 0.99999914],
       [0.08424419, 0.91575581],
       [0.00000008, 0.99999992],
       [0.02639328, 0.97360672],
       [0.00000015, 0.99999985],
       [0.0700967 , 0.9299033 ],
       [0.00003865, 0.99996135],
       [0.03230223, 0.96769777],
       [0.00010738, 0.99989262],
       [0.02639328, 0.97360672],
       [0.00000791, 0.99999209],
       [0.08424419, 0.91575581],
       [0.00017707, 0.99982293],
       [0.00923671, 0.99076329],
       [0.00001352, 0.99998648],
       [0.00478639, 0.99521361],
       [0.00006465, 0.99993535],
       [0.02639328, 0.97360672],
       [0.00000459, 0.99999541],
       [0.01145015, 0.98854985],
       [0.00047123, 0.99952877],
       [0.00597153, 0.99402847],
       [0.00923671, 0.99076329],
       [0.0700967 , 0.9299033 ],
       [0.00028991, 0.99971009],
       [0.01145015, 0.98854985],
       [0.00000791, 0.99999209],
       [0.00382873, 0.99617127],
       [0.00002294, 0.99997706],
       [0.00002294, 0.99997706],
       [0.03941269, 0.96058731],
       [0.00002294, 0.99997706],
       [0.10077498, 0.89922502],
       [0.00002294, 0.99997706],
       [0.00305663, 0.99694337],
       [0.00000015, 0.99999985],
       [0.05807624, 0.94192376],
       [0.00002294, 0.99997706],
       [0.33762084, 0.66237916],
       [0.00000049, 0.99999951],
       [0.00000008, 0.99999992],
       [0.00597153, 0.99402847],
       [0.01145015, 0.98854985],
       [0.00000152, 0.99999848],
       [0.00047123, 0.99952877],
       [0.00006465, 0.99993535],
       [0.9901227 , 0.0098773 ],
       [0.92164831, 0.07835169],
       [0.979321  , 0.020679  ],
       [0.98887183, 0.01112817],
       [0.96948891, 0.03051109],
       [0.897057  , 0.102943  ],
       [0.99671239, 0.00328761],
       [0.96517864, 0.03482136],
       [0.70958652, 0.29041348],
       [0.97323387, 0.02676613],
       [0.95450217, 0.04549783],
       [0.96021617, 0.03978383],
       [0.97323387, 0.02676613],
       [0.82396771, 0.17603229],
       [0.98580699, 0.01419301],
       [0.82396771, 0.17603229],
       [0.9959592 , 0.0040408 ],
       [0.97323387, 0.02676613],
       [0.99218012, 0.00781988],
       [0.29796695, 0.70203305],
       [0.98393382, 0.01606618],
       [0.99376753, 0.00623247],
       [0.99905495, 0.00094505],
       [0.95450217, 0.04549783],
       [0.9959592 , 0.0040408 ],
       [0.70958652, 0.29041348],
       [0.99376753, 0.00623247],
       [0.95450217, 0.04549783],
       [0.97323387, 0.02676613],
       [0.11993516, 0.88006484],
       [0.99730642, 0.00269358],
       [0.46620345, 0.53379655],
       [0.99499884, 0.00500116],
       [0.77241466, 0.22758534],
       [0.98393382, 0.01606618],
       [0.92164831, 0.07835169],
       [0.94035329, 0.05964671],
       [0.01747265, 0.98252735],
       [0.999458  , 0.000542  ],
       [0.16697628, 0.83302372],
       [0.897057  , 0.102943  ],
       [0.979321  , 0.020679  ],
       [0.98744239, 0.01255761],
       [0.9901227 , 0.0098773 ],
       [0.97648929, 0.02351071],
       [0.22643912, 0.77356088],
       [0.99376753, 0.00623247],
       [0.46620345, 0.53379655],
       [0.99671239, 0.00328761],
       [0.97648929, 0.02351071],
       [0.99550848, 0.00449152],
       [0.897057  , 0.102943  ],
       [0.98393382, 0.01606618],
       [0.82396771, 0.17603229],
       [0.99499884, 0.00500116],
       [0.99218012, 0.00781988],
       [0.99671239, 0.00328761],
       [0.82396771, 0.17603229],
       [0.95450217, 0.04549783],
       [0.98887183, 0.01112817],
       [0.897057  , 0.102943  ],
       [0.979321  , 0.020679  ],
       [0.979321  , 0.020679  ],
       [0.86503796, 0.13496204],
       [0.99376753, 0.00623247],
       [0.96021617, 0.03978383],
       [0.77241466, 0.22758534],
       [0.96021617, 0.03978383]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9358288770053476
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sklearn_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9358288770053476
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
      <td>0.468574</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
      <td>0.418540</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
      <td>0.636281</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
      <td>0.053040</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
      <td>0.002379</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
      <td>0.092726</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 12 columns</p>
</div></div></div>
</div>
<section id="putting-the-naive-into-naive-bayes">
<h2>Putting the naïve into “naïve Bayes”<a class="headerlink" href="#putting-the-naive-into-naive-bayes" title="Permalink to this heading">#</a></h2>
<p>Now, let’s also consider the <code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code> values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;bill_depth_mm&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="_images/93c67b9d5cdf4b38c326cca109981ea547abc1dd5de6aac327dbbe7d4f01f4d6.png" src="_images/93c67b9d5cdf4b38c326cca109981ea547abc1dd5de6aac327dbbe7d4f01f4d6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bd_by_species</span> <span class="o">=</span> <span class="n">by_species</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]</span>
<span class="n">bd_params</span> <span class="o">=</span> <span class="n">bd_by_species</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="c1"># The distributions</span>
<span class="n">pd_dists</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
    <span class="n">pd_dists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bd_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                              <span class="n">bd_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>

<span class="n">pd_dists</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Chinstrap&#39;: &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen at 0x7f0186180580&gt;,
 &#39;Gentoo&#39;: &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen at 0x7f017a856610&gt;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species</span><span class="p">):</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">bds</span> <span class="o">=</span> <span class="n">bd_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bds</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">bds</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bds</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd_dists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">);</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> density / est density&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/90fc7107a8d8bf52facff82074cbb9d8e880ad1feb54839196eef2d6f4a60680.png" src="_images/90fc7107a8d8bf52facff82074cbb9d8e880ad1feb54839196eef2d6f4a60680.png" />
</div>
</div>
<p>We can also think of these distributions in two-dimensions, along with the weight:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;body_mass_g&#39;, ylabel=&#39;bill_depth_mm&#39;&gt;
</pre></div>
</div>
<img alt="_images/45a07d42dc0dad0aecbb44c523ec6d385fc66af1c90be51efa757dfc9eabfe59.png" src="_images/45a07d42dc0dad0aecbb44c523ec6d385fc66af1c90be51efa757dfc9eabfe59.png" />
</div>
</div>
<p>Question - is the bill depth <em>independent</em> (in the sense of probability) from
the body mass?   That is - if I know the body mass, do I know anything more
about the bill depth?</p>
<p>For the moment - let’s say “yes” (it’s independent).  That’s <em>naïve</em>.  And
that’s where “naïve” Bayes reaches the name of the technique.</p>
<p>Using independence, we can calculate the probability of a <em>combination</em> of a particular body mass and bill depth value with:</p>
<div class="math notranslate nohighlight">
\[
P((\text{mass} \text{ and } \text{bill depth}) | \text{Chinstrap} ) =
P(\text{mass} | \text{Chinstrap}) *
P(\text{bill depth}) | \text{Chinstrap})
\]</div>
<p>Let’s calculate the new probabilities we need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_dists</span><span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_g&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_dists</span><span class="p">[</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
      <th>p_bd_given_c</th>
      <th>p_bd_given_g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
      <td>0.468574</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000009</td>
      <td>0.076922</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.061416</td>
      <td>0.168890</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
      <td>0.418540</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000252</td>
      <td>0.267586</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.006289</td>
      <td>0.396093</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
      <td>0.636281</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000905</td>
      <td>0.356404</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
      <td>0.053040</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.167976</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
      <td>0.002379</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.337638</td>
      <td>0.002857</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.344799</td>
      <td>0.002066</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
      <td>0.092726</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.308470</td>
      <td>0.000106</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.340888</td>
      <td>0.000350</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 14 columns</p>
</div></div></div>
</div>
<p>The full formula for the posterior using the two measures is:</p>
<div class="math notranslate nohighlight">
\[
P(\text{Chinstrap} | \text{mass and bill depth}) = \frac{
P((\text{mass and bill_depth}) | \text{Chinstrap}) P(\text{Chinstrap})
}{P(\text{mass and bill depth})}
\]</div>
<p>The naïve version of the formula is:</p>
<div class="math notranslate nohighlight">
\[
P(\text{Chinstrap} | \text{mass and bill depth}) = \frac{
P(\text{mass} | \text{Chinstrap}) *
P(\text{bill depth}) | \text{Chinstrap}) *
 P(\text{Chinstrap})
}{P(\text{mass and bill depth})}
\]</div>
<p>But - using the likelihood trick above, we no longer have to calculate the denominator, we can just divide it out, to give the following ratio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">both_ratio</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">])</span> <span class="o">/</span>
              <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;both_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">both_ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
      <th>p_bd_given_c</th>
      <th>p_bd_given_g</th>
      <th>both_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.417687e-04</td>
      <td>0.000396</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000538</td>
      <td>0.095880</td>
      <td>0.468574</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000009</td>
      <td>0.076922</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.061416</td>
      <td>0.168890</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.822409e-04</td>
      <td>0.000350</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000532</td>
      <td>0.124470</td>
      <td>0.418540</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000252</td>
      <td>0.267586</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>2.132690e-09</td>
      <td>0.000382</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000382</td>
      <td>0.000002</td>
      <td>0.636360</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.006289</td>
      <td>0.396093</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>8.540955e-08</td>
      <td>0.000659</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000659</td>
      <td>0.000047</td>
      <td>0.636281</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000905</td>
      <td>0.356404</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.155872e-04</td>
      <td>0.000074</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000890</td>
      <td>0.333328</td>
      <td>0.053040</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.167976</td>
      <td>0.000003</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.130179e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000716</td>
      <td>0.362277</td>
      <td>0.002379</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.337638</td>
      <td>0.002857</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.344799</td>
      <td>0.002066</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.581042e-04</td>
      <td>0.000112</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.000770</td>
      <td>0.310650</td>
      <td>0.092726</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.308470</td>
      <td>0.000106</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.031853e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>0.001057</td>
      <td>0.354956</td>
      <td>0.015190</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.340888</td>
      <td>0.000350</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 15 columns</p>
</div></div></div>
</div>
<p>Accuracy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;both_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Scikit learn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">both_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">both_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">both_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Let’s try the standard test-train split.  We “train” our classifier using a random subset of the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]],</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
<span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>298</th>
      <td>2900.0</td>
      <td>16.6</td>
    </tr>
    <tr>
      <th>205</th>
      <td>5000.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>162</th>
      <td>4650.0</td>
      <td>13.7</td>
    </tr>
    <tr>
      <th>315</th>
      <td>4500.0</td>
      <td>19.9</td>
    </tr>
    <tr>
      <th>264</th>
      <td>4650.0</td>
      <td>15.2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>179</th>
      <td>5650.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>296</th>
      <td>3600.0</td>
      <td>17.3</td>
    </tr>
    <tr>
      <th>312</th>
      <td>3850.0</td>
      <td>18.3</td>
    </tr>
    <tr>
      <th>159</th>
      <td>5200.0</td>
      <td>15.3</td>
    </tr>
    <tr>
      <th>309</th>
      <td>4100.0</td>
      <td>18.8</td>
    </tr>
  </tbody>
</table>
<p>140 rows × 2 columns</p>
</div></div></div>
</div>
<p>Here we fit the various parameters to classify the training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">test_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div>
</div>
<p>How does Scikit-learn do in classifying the test data (that it has not seen
before):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>We can look at the <em>decision boundary</em> to see where the model starts seeing
Chinstrap and Gentoo penguins, as it moves through the 2D space of parameters
(mass and bill depth).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make grid of points to classify</span>
<span class="n">all_params</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">bm_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">],</span>
                   <span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">],</span>
                   <span class="mi">50</span><span class="p">)</span>
<span class="n">bm_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">],</span>
                   <span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">],</span>
                   <span class="mi">50</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">bm_x</span><span class="p">,</span> <span class="n">bm_y</span><span class="p">)</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the classification of the test data.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="c1"># Overlay the classification of the grid points.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">test_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xy_df</span><span class="p">),</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[:</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23ea00a3a3fe30fec79777ec5baa42d31fc1ce6bea588ba4926fb8fecb24f001.png" src="_images/23ea00a3a3fe30fec79777ec5baa42d31fc1ce6bea588ba4926fb8fecb24f001.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "lisds/dsip",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-the-naive-into-naive-bayes">Putting the naïve into “naïve Bayes”</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Matthew Brett and Peter Rush
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>