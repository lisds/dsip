

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Naive Bayes classifiers &#8212; Data Science in Practice</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'naive_bayes';</script>
    <link rel="canonical" href="https://lisds.github.io/dsip/naive_bayes.html" />
    <link rel="shortcut icon" href="_static/dsfe_favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="k-means clustering" href="k_means.html" />
    <link rel="prev" title="Multiple Logistic Regression, Model Selection and Cross-validation" href="logistic_regression_cross_validation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/dsfe_logo.png" class="logo__image only-light" alt="Data Science in Practice - Home"/>
    <script>document.write(`<img src="_static/dsfe_logo.png" class="logo__image only-dark" alt="Data Science in Practice - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="assert.html">Using <code class="docutils literal notranslate"><span class="pre">assert</span></code> for testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays_and_images.html">Arrays as images, images as arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="where_and_argmin.html">Where and argmin</a></li>
<li class="toctree-l1"><a class="reference internal" href="where_2d.html">Where in 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_for_optimize.html">2D arrays, images, optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="pathlib.html">Using the <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dictionaries.html">Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas_and_dicts.html">Pandas and dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda_functions.html">Lambda functions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reading formulae</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="numpy_and_vectors.html">Numpy, arrays, and vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebra_of_sums.html">Some algebra with summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lin_regression_notation.html">Notation for linear regression models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Intermediate regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lin_regression_multiple_predictors.html">Linear regression notation for models with multiple predictors</a></li>
<li class="toctree-l1"><a class="reference internal" href="epl_modeling.html">Attack or defense?  An example of multiple regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_regression_categorical_predictors.html">Categorical predictors in linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_predictors_statistical_adjustment.html">Statistical Adjustment in Multi-predictor Linear Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="logistic_regression_cross_validation.html">Multiple Logistic Regression, Model Selection and Cross-validation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Classification</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Naive Bayes classifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="k_means.html">k-means clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernel_density_estimation.html">Kernel density estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Working with data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data_work.html">The problem with data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing on your computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-problem-with-notebooks.html">The joys and sorrows of notebooks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/lisds/dsip/main?urlpath=lab/tree/naive_bayes.Rmd" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://ds.lis.2i2c.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/lisds/dsip&urlpath=lab/tree/dsip/naive_bayes.Rmd&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lisds/dsip" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lisds/dsip/edit/main/naive_bayes.Rmd" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lisds/dsip/issues/new?title=Issue%20on%20page%20%2Fnaive_bayes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/naive_bayes.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Naive Bayes classifiers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#enumerate">Enumerate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#towards-classification-with-probability">Towards classification with probability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-the-naive-into-naive-bayes">Putting the naïve into “naïve Bayes”</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="naive-bayes-classifiers">
<h1>Naive Bayes classifiers<a class="headerlink" href="#naive-bayes-classifiers" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.copy_on_write&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Also see: <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/05.05-naive-bayes.html">Naive Bayes
classifiers</a>
in the <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook">Python Data Science
Handbook</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/penguins.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">penguins</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>55.8</td>
      <td>19.8</td>
      <td>207.0</td>
      <td>4000.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>43.5</td>
      <td>18.1</td>
      <td>202.0</td>
      <td>3400.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>49.6</td>
      <td>18.2</td>
      <td>193.0</td>
      <td>3775.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.8</td>
      <td>19.0</td>
      <td>210.0</td>
      <td>4100.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.2</td>
      <td>18.7</td>
      <td>198.0</td>
      <td>3775.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
<p>333 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fe86d48ea00&gt;
</pre></div>
</div>
<img alt="_images/4ccee6cd1036f19a6fc38e782c6f918a3cd209b4a6f81e10e1e8be13d85f430d.png" src="_images/4ccee6cd1036f19a6fc38e782c6f918a3cd209b4a6f81e10e1e8be13d85f430d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">species_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">species_names</span><span class="p">),</span>
    <span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;body_mass_g&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;body_mass_g&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="_images/d1ad5a7b31f3386cf86a9739e31230f75945c8fbc424fb78aa5815d587c7de04.png" src="_images/d1ad5a7b31f3386cf86a9739e31230f75945c8fbc424fb78aa5815d587c7de04.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_species</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="n">bm_by_species</span> <span class="o">=</span> <span class="n">by_species</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">));</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Gentoo&#39;)
</pre></div>
</div>
<img alt="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" src="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" />
</div>
</div>
<section id="enumerate">
<h2>Enumerate<a class="headerlink" href="#enumerate" title="Permalink to this heading">#</a></h2>
<p>While we are here — we introduce <code class="docutils literal notranslate"><span class="pre">enumerate</span></code>.</p>
<p>Imagine we need <em>both</em> the elements in a list, <em>and</em> the position of that element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">position_no</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># A variable to keep track of the position (index).</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">species_names</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">position_no</span><span class="p">,</span> <span class="s1">&#39;name is&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">position_no</span> <span class="o">=</span> <span class="n">position_no</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># We have to increment the position.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group 0 name is Chinstrap
Group 1 name is Gentoo
</pre></div>
</div>
</div>
</div>
<p>We can avoid the extra variable by using <code class="docutils literal notranslate"><span class="pre">enumerate</span></code>, wrapped around the set of
things we want to process.  <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> returns two things at each step — the
position (index), and the next element from the set of things.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">position_no</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species_names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">position_no</span><span class="p">,</span> <span class="s1">&#39;name is&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group 0 name is Chinstrap
Group 1 name is Gentoo
</pre></div>
</div>
</div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> to do the plots more neatly below.</p>
<p>The plots again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species_names</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" src="_images/9bcabb7b139623c05551213df1c36cd33e86eaa9d7081954c3d0f3b205d984a4.png" />
</div>
</div>
</section>
<section id="towards-classification-with-probability">
<h2>Towards classification with probability<a class="headerlink" href="#towards-classification-with-probability" title="Permalink to this heading">#</a></h2>
<p>We are going to start to think about getting the probability of a particular
<em>mass</em> given we have a Chinstrap or a Gentoo penguin.  We might like to start
with density histograms.  Here was ask Matplotlib to set the area of the bars
to sum to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species_names</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0b5ea5243c3f31ffaeee5972e29bc116abb62ab165031b3c3499dd70b73e0bf.png" src="_images/a0b5ea5243c3f31ffaeee5972e29bc116abb62ab165031b3c3499dd70b73e0bf.png" />
</div>
</div>
<p>For the moment, let us model these two distributions as normal curves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Notice the Numpy std function (variance divisor is n rather than</span>
<span class="c1"># (n - 1).  This is to match scikit-learn&#39;s implementation.</span>
<span class="n">bm_params</span> <span class="o">=</span> <span class="n">bm_by_species</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">bm_params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>species</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chinstrap</th>
      <td>3733.088235</td>
      <td>381.498621</td>
    </tr>
    <tr>
      <th>Gentoo</th>
      <td>5092.436975</td>
      <td>499.364666</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use a Scipy statistics distribution to make a <em>normal</em> distribution with
the same mean and standard deviation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">sps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A normal distribution with the same mean and standard deviation.</span>
<span class="n">chinstrap_dist</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                          <span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The probability density function of the distribution:</span>
<span class="n">chinstraps</span> <span class="o">=</span> <span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">)</span>
<span class="n">c_masses_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">chinstraps</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">chinstraps</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">,</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe8640868b0&gt;]
</pre></div>
</div>
<img alt="_images/fcff45b3d27006efd9a46532489ac3b90270db832024edaa7976890754374763.png" src="_images/fcff45b3d27006efd9a46532489ac3b90270db832024edaa7976890754374763.png" />
</div>
</div>
<p>This is the plot along with the actual densities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">chinstraps</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">,</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">c_masses_x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe863ffd0d0&gt;]
</pre></div>
</div>
<img alt="_images/3e59543a657da9fa0973942c8ed05fab31bef0313fcab0d6e38d998dae1d0822.png" src="_images/3e59543a657da9fa0973942c8ed05fab31bef0313fcab0d6e38d998dae1d0822.png" />
</div>
</div>
<p>The normal (Gaussian) probability density function gives our estimate of the
probability (density) of any given weight.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">3500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0008676740928442561
</pre></div>
</div>
</div>
</div>
<p>With these we can get the probability of any mass in the dataset given that the
penguin is a Chinstrap:</p>
<div class="math notranslate nohighlight">
\[
P(\text{mass} | \text{Chinstrap})
\]</div>
<p>Actually, to be concise, let’s use <span class="math notranslate nohighlight">\(m\)</span> for <span class="math notranslate nohighlight">\(\text{mass}\)</span> and <span class="math notranslate nohighlight">\(C\)</span> for
<span class="math notranslate nohighlight">\(\text{Chinstrap}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
P(m | C)
\]</div>
<p>We fill in the values of <span class="math notranslate nohighlight">\(P(m | C)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chinstrap_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 4 columns</p>
</div></div></div>
</div>
<p>Likewise:</p>
<div class="math notranslate nohighlight">
\[
P(\text{mass}|\text{Gentoo})
\]</div>
<p>which we will write as:</p>
<div class="math notranslate nohighlight">
\[
P(m | G)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gentoo_dist</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                       <span class="n">bm_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="n">gentoos</span> <span class="o">=</span> <span class="n">bm_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">g_masses_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">gentoos</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gentoos</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">gentoos</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g_masses_x</span><span class="p">,</span> <span class="n">gentoo_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">g_masses_x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gentoo density and estimated density&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/022fb98298ac772c7b867020245bcc809c574a87f25092167e2f146f45966117.png" src="_images/022fb98298ac772c7b867020245bcc809c574a87f25092167e2f146f45966117.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gentoo_dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 5 columns</p>
</div></div></div>
</div>
<p>We also need prior probabilities for Chinstrap (<span class="math notranslate nohighlight">\(C\)</span>) and Gentoo (<span class="math notranslate nohighlight">\(G\)</span>):</p>
<div class="math notranslate nohighlight">
\[
P(C)
\]</div>
<div class="math notranslate nohighlight">
\[
P(G)
\]</div>
<p>Let’s just use the proportions in the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_chinstrap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Chinstrap&#39;</span><span class="p">)</span>
<span class="n">p_chinstrap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36363636363636365
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_gentoo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">p_gentoo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6363636363636364
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_chinstrap</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_gentoo</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 7 columns</p>
</div></div></div>
</div>
<p>In our model, each individual mass can only come about in one of two
situations: the penguin is a Chinstrap, or the penguin is a Gentoo.  That is, the mass can only come about in these situations:</p>
<div class="math notranslate nohighlight">
\[
P(m \text{ and } C)
\]</div>
<p>or:</p>
<div class="math notranslate nohighlight">
\[
P(m \text{ and } G)
\]</div>
<p>But:</p>
<div class="math notranslate nohighlight">
\[
P(m \text{ and } C) = P(m | C) P(C)
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
P(m \text{ and } G) = P(m | G) P(G)
\]</div>
<p>Let’s calculate those now:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_and_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_and_g&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(P(m \text{ and } C)\)</span>, <span class="math notranslate nohighlight">\(P(m \text{ and } G)\)</span> are
mutually exclusive, so we add the probabilities to give the probability of
getting a particular mass value <span class="math notranslate nohighlight">\(m\)</span>:</p>
<div class="math notranslate nohighlight">
\[
P(m) = P(m \text{ and } C) + P(m \text{ and } G)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_and_c&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_and_g&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 10 columns</p>
</div></div></div>
</div>
<p>How we have everything we need to work out the <em>posterior</em> probability that
a penguin is a Chinstrap, given the weight of the penguin:</p>
<div class="math notranslate nohighlight">
\[
P(C | m) = \frac{P(m | C) * P(C)}{P(m)}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_mass&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
      <td>0.166976</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
      <td>0.226439</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
      <td>0.000065</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
      <td>0.865038</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
      <td>0.993768</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
      <td>0.772415</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 11 columns</p>
</div></div></div>
</div>
<p>Likewise:</p>
<div class="math notranslate nohighlight">
\[
P(G | m) = \frac{P(m | G) * P(G)}{P(m)}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_g_given_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_mass&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
      <td>0.166976</td>
      <td>0.833024</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
      <td>0.226439</td>
      <td>0.773561</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
      <td>0.000065</td>
      <td>0.999935</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
      <td>0.865038</td>
      <td>0.134962</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
      <td>0.993768</td>
      <td>0.006232</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
      <td>0.772415</td>
      <td>0.227585</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bayes_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_g_given_m&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
      <td>0.166976</td>
      <td>0.833024</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
      <td>0.226439</td>
      <td>0.773561</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
      <td>0.000065</td>
      <td>0.999935</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
      <td>0.865038</td>
      <td>0.134962</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
      <td>0.993768</td>
      <td>0.006232</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
      <td>0.772415</td>
      <td>0.227585</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 13 columns</p>
</div></div></div>
</div>
<p>But - wait - for our Bayes predictions, we don’t actually need the <span class="math notranslate nohighlight">\(P(\text{mass})\)</span> value.  Why?  Because we can calculate the ratio of the posterior probabilities like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\text{LR} = \frac{P(C | m)}{P(G | m)}  \\
= \frac
{\frac{ P(m | C) * P(C) } { P(m) }}
{\frac{P(m | G) * P(G)} { P(m) }} \\
= \frac{P(m | C) * P(C)} {P(m | G) * P(G)}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">likelihood_ratio</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">])</span> <span class="o">/</span>
                    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From the divide-out trick above, this gives us the same as:</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">likelihood_ratio</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_g_given_m&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Notice we have divided out the <span class="math notranslate nohighlight">\(P(\text{mass})\)</span> in this ratio.  Notice too that ratios above 1 mean more likely Chinstrap, and less than one mean less likely Chinstrap, more likely Gentoo.  So we get the same predictions from the likelihood as we would from the full posterior probabilities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">likelihood_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">likelihood_ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bayes_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">likelihood_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>As you may remember from the logit transform in logistic regression, we can also get probabilities from the likelihood ratios, with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Probability from likelihood ratio</span>
<span class="n">p_from_lr</span> <span class="o">=</span> <span class="n">likelihood_ratio</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">likelihood_ratio</span><span class="p">)</span>
<span class="n">p_from_lr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>152    0.166976
153    0.000003
154    0.226439
155    0.000003
156    0.000065
         ...   
339    0.865038
340    0.993768
341    0.960216
342    0.772415
343    0.960216
Length: 187, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Here is the same process, using the Scikit-learn library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]);</span>
<span class="n">model</span><span class="o">.</span><span class="n">class_prior_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.36363636, 0.63636364])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sklearn_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
      <td>0.166976</td>
      <td>0.833024</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
      <td>0.226439</td>
      <td>0.773561</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
      <td>0.000065</td>
      <td>0.999935</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
      <td>0.865038</td>
      <td>0.134962</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
      <td>0.993768</td>
      <td>0.006232</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
      <td>0.772415</td>
      <td>0.227585</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 14 columns</p>
</div></div></div>
</div>
<p>Scikit-learn gives the same predictions as we do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bayes_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sklearn_predictions&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Scikit-learn also calculates the posterior probabilities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The predict_proba values are just the posteriors.</span>
<span class="n">skl_posteriors</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]])</span>
<span class="c1"># They are the same as ours, with calculation error.</span>
<span class="n">our_posteriors</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;p_c_given_m&#39;</span><span class="p">,</span> <span class="s1">&#39;p_g_given_m&#39;</span><span class="p">]]</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">skl_posteriors</span><span class="p">,</span> <span class="n">our_posteriors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">score</span></code> is the proportion of labels we predicted correctly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9358288770053476
</pre></div>
</div>
</div>
</div>
<p>Here we calculated the same value by hand(ish):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sklearn_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9358288770053476
</pre></div>
</div>
</div>
</div>
</section>
<section id="putting-the-naive-into-naive-bayes">
<h2>Putting the naïve into “naïve Bayes”<a class="headerlink" href="#putting-the-naive-into-naive-bayes" title="Permalink to this heading">#</a></h2>
<p>Now, let’s also consider the <code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code> values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;bill_depth_mm&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="_images/93c67b9d5cdf4b38c326cca109981ea547abc1dd5de6aac327dbbe7d4f01f4d6.png" src="_images/93c67b9d5cdf4b38c326cca109981ea547abc1dd5de6aac327dbbe7d4f01f4d6.png" />
</div>
</div>
<p>Make the distributions for bill depth:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bd_by_species</span> <span class="o">=</span> <span class="n">by_species</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]</span>
<span class="n">bd_params</span> <span class="o">=</span> <span class="n">bd_by_species</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># The distributions</span>
<span class="n">pd_dists</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
    <span class="n">pd_dists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bd_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                              <span class="n">bd_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>

<span class="n">pd_dists</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Chinstrap&#39;: &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen at 0x7fe864256be0&gt;,
 &#39;Gentoo&#39;: &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen at 0x7fe867662d90&gt;}
</pre></div>
</div>
</div>
</div>
<p>Plot the actual and estimated density, using the Gaussian approximations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species</span><span class="p">):</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">bds</span> <span class="o">=</span> <span class="n">bd_by_species</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bds</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">bds</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bds</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd_dists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r:&#39;</span><span class="p">);</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> density / est density&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e0e916d01bb5321915042dd9680bc54eb1a0ef7e3e17a8088733b8a2d7514a0.png" src="_images/8e0e916d01bb5321915042dd9680bc54eb1a0ef7e3e17a8088733b8a2d7514a0.png" />
</div>
</div>
<p>We can also think of these distributions in two dimensions, along with the
mass:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;body_mass_g&#39;, ylabel=&#39;bill_depth_mm&#39;&gt;
</pre></div>
</div>
<img alt="_images/45a07d42dc0dad0aecbb44c523ec6d385fc66af1c90be51efa757dfc9eabfe59.png" src="_images/45a07d42dc0dad0aecbb44c523ec6d385fc66af1c90be51efa757dfc9eabfe59.png" />
</div>
</div>
<p>Question - is the bill depth <em>independent</em> (in the sense of probability) from
the body mass?   That is - if I know the body mass, do I know anything more
about the bill depth?</p>
<p>For the moment - let’s say “yes” (it’s independent).  That’s <em>naïve</em>.  And
that’s where “naïve” Bayes reaches the name of the technique.</p>
<p>Using independence, we can calculate the probability of a <em>combination</em> of a particular body mass and bill depth value.</p>
<p>Call <span class="math notranslate nohighlight">\(P(d)\)</span> the probability of a particular bill depth value.  Naïve Bayes
estimates the probability of the combination with:</p>
<div class="math notranslate nohighlight">
\[
P((m \text{ and } d) | C) = P(m | C) * P(d | C)
\]</div>
<p>Let’s calculate the new probabilities we need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_dists</span><span class="p">[</span><span class="s1">&#39;Chinstrap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_g&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_dists</span><span class="p">[</span><span class="s1">&#39;Gentoo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
      <th>p_bd_given_c</th>
      <th>p_bd_given_g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
      <td>0.166976</td>
      <td>0.833024</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000008</td>
      <td>0.076169</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.060282</td>
      <td>0.168353</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
      <td>0.226439</td>
      <td>0.773561</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000228</td>
      <td>0.267777</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.005967</td>
      <td>0.397696</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
      <td>0.000065</td>
      <td>0.999935</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000834</td>
      <td>0.357527</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
      <td>0.865038</td>
      <td>0.134962</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.167371</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
      <td>0.993768</td>
      <td>0.006232</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.339946</td>
      <td>0.002751</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.347265</td>
      <td>0.001984</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
      <td>0.772415</td>
      <td>0.227585</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.310160</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.343268</td>
      <td>0.000331</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 16 columns</p>
</div></div></div>
</div>
<p>The full formula for the posterior using the two measures is:</p>
<div class="math notranslate nohighlight">
\[
P(C | (m \text{ and } d)) = \frac{
P((m \text{ and } d) | C) * P(C)
}{P(m \text{ and } d)}
\]</div>
<p>The naïve version of the formula is:</p>
<div class="math notranslate nohighlight">
\[
P(C | (m \text{ and } d)) = \frac{
P(m | C) * P(d | C) * P(C)
}{P(m \text{ and } d)}
\]</div>
<p>But - using the likelihood trick above, we no longer have to calculate the
denominator, we can just divide it out, to give the following ratio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">both_ratio</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_chinstrap&#39;</span><span class="p">])</span> <span class="o">/</span>
              <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_m_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_bd_given_g&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_gentoo&#39;</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;both_predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">both_ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Chinstrap&#39;</span><span class="p">,</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
      <th>p_m_given_c</th>
      <th>p_m_given_g</th>
      <th>p_chinstrap</th>
      <th>p_gentoo</th>
      <th>p_m_and_c</th>
      <th>p_m_and_g</th>
      <th>p_mass</th>
      <th>p_c_given_m</th>
      <th>p_g_given_m</th>
      <th>bayes_predictions</th>
      <th>sklearn_predictions</th>
      <th>p_bd_given_c</th>
      <th>p_bd_given_g</th>
      <th>both_predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>Gentoo</td>
      <td>4500.0</td>
      <td>13.2</td>
      <td>1.386413e-04</td>
      <td>0.000395</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>5.041503e-05</td>
      <td>0.000252</td>
      <td>0.000302</td>
      <td>0.166976</td>
      <td>0.833024</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000008</td>
      <td>0.076169</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>16.3</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.060282</td>
      <td>0.168353</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Gentoo</td>
      <td>4450.0</td>
      <td>14.1</td>
      <td>1.788899e-04</td>
      <td>0.000349</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.505088e-05</td>
      <td>0.000222</td>
      <td>0.000287</td>
      <td>0.226439</td>
      <td>0.773561</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000228</td>
      <td>0.267777</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Gentoo</td>
      <td>5700.0</td>
      <td>15.2</td>
      <td>1.767096e-09</td>
      <td>0.000381</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>6.425805e-10</td>
      <td>0.000243</td>
      <td>0.000243</td>
      <td>0.000003</td>
      <td>0.999997</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.005967</td>
      <td>0.397696</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Gentoo</td>
      <td>5400.0</td>
      <td>14.5</td>
      <td>7.477526e-08</td>
      <td>0.000661</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.719100e-08</td>
      <td>0.000421</td>
      <td>0.000421</td>
      <td>0.000065</td>
      <td>0.999935</td>
      <td>Gentoo</td>
      <td>Gentoo</td>
      <td>0.000834</td>
      <td>0.357527</td>
      <td>Gentoo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>4000.0</td>
      <td>19.8</td>
      <td>8.186991e-04</td>
      <td>0.000073</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.977088e-04</td>
      <td>0.000046</td>
      <td>0.000344</td>
      <td>0.865038</td>
      <td>0.134962</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.167371</td>
      <td>0.000003</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>3400.0</td>
      <td>18.1</td>
      <td>7.143042e-04</td>
      <td>0.000003</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.597470e-04</td>
      <td>0.000002</td>
      <td>0.000261</td>
      <td>0.993768</td>
      <td>0.006232</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.339946</td>
      <td>0.002751</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.2</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.347265</td>
      <td>0.001984</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>4100.0</td>
      <td>19.0</td>
      <td>6.585033e-04</td>
      <td>0.000111</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>2.394557e-04</td>
      <td>0.000071</td>
      <td>0.000310</td>
      <td>0.772415</td>
      <td>0.227585</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.310160</td>
      <td>0.000100</td>
      <td>Chinstrap</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>3775.0</td>
      <td>18.7</td>
      <td>1.039432e-03</td>
      <td>0.000025</td>
      <td>0.363636</td>
      <td>0.636364</td>
      <td>3.779754e-04</td>
      <td>0.000016</td>
      <td>0.000394</td>
      <td>0.960216</td>
      <td>0.039784</td>
      <td>Chinstrap</td>
      <td>Chinstrap</td>
      <td>0.343268</td>
      <td>0.000331</td>
      <td>Chinstrap</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 17 columns</p>
</div></div></div>
</div>
<p>Accuracy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;both_predictions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Scikit learn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">both_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">both_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">both_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Let’s try the standard test-train split.  We “train” our classifier using a random subset of the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]],</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
<span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>body_mass_g</th>
      <th>bill_depth_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>320</th>
      <td>3675.0</td>
      <td>17.9</td>
    </tr>
    <tr>
      <th>250</th>
      <td>4625.0</td>
      <td>14.4</td>
    </tr>
    <tr>
      <th>310</th>
      <td>3600.0</td>
      <td>18.6</td>
    </tr>
    <tr>
      <th>155</th>
      <td>5700.0</td>
      <td>15.2</td>
    </tr>
    <tr>
      <th>328</th>
      <td>3600.0</td>
      <td>17.3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>309</th>
      <td>4100.0</td>
      <td>18.8</td>
    </tr>
    <tr>
      <th>207</th>
      <td>5050.0</td>
      <td>15.4</td>
    </tr>
    <tr>
      <th>321</th>
      <td>4450.0</td>
      <td>18.5</td>
    </tr>
    <tr>
      <th>168</th>
      <td>4150.0</td>
      <td>13.5</td>
    </tr>
    <tr>
      <th>289</th>
      <td>4050.0</td>
      <td>18.1</td>
    </tr>
  </tbody>
</table>
<p>140 rows × 2 columns</p>
</div></div></div>
</div>
<p>Here we fit the various parameters to classify the training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">test_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div>
</div>
<p>How does Scikit-learn do in classifying the test data (that it has not seen
before):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>We can look at the <em>decision boundary</em> to see where the model starts seeing
Chinstrap and Gentoo penguins, as it moves through the 2D space of parameters
(mass and bill depth).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make grid of points to classify</span>
<span class="n">all_params</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">bm_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">],</span>
                   <span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">],</span>
                   <span class="mi">50</span><span class="p">)</span>
<span class="n">bm_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">],</span>
                   <span class="n">all_params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">],</span>
                   <span class="mi">50</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">bm_x</span><span class="p">,</span> <span class="n">bm_y</span><span class="p">)</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the classification of the test data.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="c1"># Overlay the classification of the grid points.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">hue</span><span class="o">=</span><span class="n">test_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xy_df</span><span class="p">),</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[:</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fe699a545aafd81fd4e0e1bcd3fecd75b90628bd192bf5c5ea1e5631e91ea1d3.png" src="_images/fe699a545aafd81fd4e0e1bcd3fecd75b90628bd192bf5c5ea1e5631e91ea1d3.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "lisds/dsip",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="logistic_regression_cross_validation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Multiple Logistic Regression, Model Selection and Cross-validation</p>
      </div>
    </a>
    <a class="right-next"
       href="k_means.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">k-means clustering</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#enumerate">Enumerate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#towards-classification-with-probability">Towards classification with probability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-the-naive-into-naive-bayes">Putting the naïve into “naïve Bayes”</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Matthew Brett and Peter Rush
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>